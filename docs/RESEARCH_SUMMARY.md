# –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ macOS Hotkey Crash - —Å–ª–æ–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏

## –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞ –∫—Ä–∞—à–∞

### –ì–¥–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º–∞

```
Thread 0 Crashed:: Dispatch queue: com.apple.main-thread
0   com.apple.HIToolbox                    0x7fff2b5c4594 TSMGetInputSourceProperty + 56
1   pynput._util.darwin.PyObjCKeyboardListener 0x104c8a3a4 func + 120
2   libsystem_malloc.dylib                 0x7fff251a9dff malloc_report_freed_object + 64
```

### –ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç

1. **TSMGetInputSourceProperty** - —ç—Ç–æ API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Input Source (Cocoa framework)
2. **–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞** - pynput —Å–æ–∑–¥–∞–µ—Ç listener –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
3. **macOS —Ç—Ä–µ–±—É–µ—Ç main thread** - –≤—Å–µ Cocoa/Carbon APIs (–≤–∫–ª—é—á–∞—è Input Source) –¥–æ–ª–∂–Ω—ã –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç**: SIGTRAP (Segmentation trap) - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –∫—Ä–∞—à –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ macOS 15.x

Apple —É—Å–∏–ª–∏–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ thread-safety –≤ Sequoia:
- –ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è Cocoa API –≤—ã–∑–æ–≤–æ–≤
- –ë–æ–ª–µ–µ –∂–µ—Å—Ç–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ thread affinity
- –õ—É—á—à–µ –æ—Ç–ª–∞–≤–ª–∏–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π

### –†–µ—à–µ–Ω–∏–µ 1: QuickMacHotKey (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø) ‚úÖ

**–ß—Ç–æ —ç—Ç–æ:**
- –ù–∞—Ç–∏–≤–Ω–∞—è macOS –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö hotkeys
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ –∂–µ Carbon/Quartz APIs —á—Ç–æ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–±–µ–≥–∞–µ—Ç threading issues

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
```
‚úÖ –ù–µ—Ç threading –ø—Ä–æ–±–ª–µ–º
‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
‚úÖ –û—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å PyInstaller
‚úÖ –ú–∞–ª–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚úÖ –ê–∫—Ç–∏–≤–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
```

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
```
‚ùå –ù—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç
‚ùå –ó–∞–≤–∏—Å–∏—Ç –æ—Ç Cocoa framework
```

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** ~30 –º–∏–Ω—É—Ç

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
import quickmachotkey

def on_f9():
    print("Recording!")

quickmachotkey.register_hotkey(101, on_f9)  # 101 = F9
quickmachotkey.listen()
```

---

### –†–µ—à–µ–Ω–∏–µ 2: NSEvent Global Monitor (Cocoa Native)

**–ß—Ç–æ —ç—Ç–æ:**
- –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ Cocoa NSEvent APIs
- –¢–æ–∂–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä, –Ω–æ –±–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
```
‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫–æ–¥–æ–º
‚úÖ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é –ª–æ–≥–∏–∫—É
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ
```

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
```
‚ùå –°–ª–æ–∂–Ω–µ–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
‚ùå –ë–æ–ª—å—à–µ –∫–æ–¥–∞
‚ùå –ù—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å Cocoa APIs
```

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** ~45 –º–∏–Ω—É—Ç

**–ü—Ä–∏–º–µ—Ä:**
```python
from Cocoa import NSEvent, NSEventMaskKeyDown, NSApplication

app = NSApplication.sharedApplication()

def hotkey_handler(event):
    if event.keyCode() == 101:  # F9
        print("Recording!")
    return event

NSEvent.addGlobalMonitorForEventsMatchingMask_handler(
    NSEventMaskKeyDown,
    hotkey_handler
)
app.run()
```

---

### –†–µ—à–µ–Ω–∏–µ 3: CGEventTap (Quartz)

**–ß—Ç–æ —ç—Ç–æ:**
- Low-level Quartz API –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –Ω–æ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
```
‚úÖ –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è (–≤–∫–ª—é—á–∞—è —Å–∫—Ä—ã—Ç—ã–µ)
‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø–æ—Ç–æ–∫–æ–º events
‚úÖ –ú–æ–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è
```

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
```
‚ùå –û—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (30+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞)
‚ùå –¢—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è Quartz
‚ùå –ú–µ–¥–ª–µ–Ω–Ω–µ–µ —á–µ–º –¥—Ä—É–≥–∏–µ —Ä–µ—à–µ–Ω–∏—è
‚ùå –ú–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å extra permissions
```

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 1.5-2 —á–∞—Å–∞

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** 9/10

---

### –†–µ—à–µ–Ω–∏–µ 4: pynput —Å Process Isolation (–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø) ‚ùå

**–ò–¥–µ—è:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å pynput listener –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
- –û–±–º–µ–Ω–∏–≤–∞—Ç—å—Å—è –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

**–ü–æ—á–µ–º—É —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```
‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Å–∞–º–æ–º pynput, –Ω–µ –≤ –ø–æ—Ç–æ–∫–µ
‚ùå –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å—Ç–æ–ª–∫–Ω–µ—Ç—Å—è —Å —Ç–æ–π –∂–µ –æ—à–∏–±–∫–æ–π
‚ùå –£—Å–ª–æ–∂–Ω—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
‚ùå –¢—Ä–µ–±—É–µ—Ç IPC (–º–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ)
‚ùå –ú–µ–¥–ª–µ–Ω–Ω–µ–µ
```

**–í—ã–≤–æ–¥:** –≠—Ç–æ –Ω–µ —Ä–µ—à–∞–µ—Ç –∫–æ—Ä–µ–Ω–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É.

---

## –ú–∞—Ç—Ä–∏—Ü–∞ –≤—ã–±–æ—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π | QuickMacHotKey | NSEvent | CGEventTap | pynput+Isolation |
|----------|---|---|---|---|
| **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** | ‚úÖ‚úÖ‚úÖ | ‚úÖ‚úÖ‚úÖ | ‚úÖ‚úÖ | ‚ùå‚ùå |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞** | ‚úÖ‚úÖ‚úÖ | ‚úÖ‚úÖ | ‚ùå | ‚ùå |
| **–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** | 30 –º–∏–Ω | 45 –º–∏–Ω | 1.5+ —á–∞—Å | 1 —á–∞—Å (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç) |
| **PyInstaller —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** | ‚úÖ‚úÖ‚úÖ | ‚úÖ‚úÖ | ‚úÖ | ‚úÖ |
| **–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ** | ‚úÖ‚úÖ‚úÖ | ‚úÖ‚úÖ | ‚ùå | ‚ùå |
| **–†–∏—Å–∫ –∫—Ä–∞—à–∞** | –û—á–µ–Ω—å –Ω–∏–∑–∫–∏–π | –ù–∏–∑–∫–∏–π | –°—Ä–µ–¥–Ω–∏–π | –í—ã—Å–æ–∫–∏–π |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –û—Ç–ª–∏—á–Ω–∞—è | –û—Ç–ª–∏—á–Ω–∞—è | –°—Ä–µ–¥–Ω—è—è | –ü–ª–æ—Ö–∞—è |

**–ò–¢–û–ì: –í—ã–±–∏—Ä–∞–µ–º QuickMacHotKey** üéØ

---

## –ü–æ—á–µ–º—É —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ workarounds –Ω–µ –ø–æ–º–æ–≥–∞—é—Ç

### Workaround 1: Delayed initialization
```python
time.sleep(0.5)  # –ñ–¥—ë–º –ø–µ—Ä–µ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π
listener.start()
```
**–ù–µ –ø–æ–º–æ–≥–∞–µ—Ç:** –ü—Ä–æ–±–ª–µ–º–∞ –≤ threading, –Ω–µ –≤ timing.

### Workaround 2: Force main thread
```python
from threading import Thread
thread = Thread(target=listener.start, daemon=False)
thread.start()
```
**–ù–µ –ø–æ–º–æ–≥–∞–µ—Ç:** pynput –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è —Å–æ–∑–¥–∞–µ—Ç —Å–≤–æ–∏ –ø–æ—Ç–æ–∫–∏ –¥–ª—è listening.

### Workaround 3: Process isolation
```python
from multiprocessing import Process
proc = Process(target=start_listener)
proc.start()
```
**–ù–µ –ø–æ–º–æ–≥–∞–µ—Ç:** –û—à–∏–±–∫–∞ –≤ pynput, –æ–Ω–∞ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –≤ –ª—é–±–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ/–ø–æ—Ç–æ–∫–µ.

### Workaround 4: Try-catch —Å restart
```python
while True:
    try:
        listener.start()
    except:
        listener.stop()
        time.sleep(1)
```
**–ù–µ –ø–æ–º–æ–≥–∞–µ—Ç:** –ö—Ä–∞—à –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ OS, try-catch –µ–≥–æ –Ω–µ –ø–æ–π–º–∞–µ—Ç.

### Workaround 5: Code signing
```bash
codesign -s - app.exe --deep
```
**–ù–µ –ø–æ–º–æ–≥–∞–µ—Ç:** Code signing –Ω–µ —Ä–µ—à–∞–µ—Ç threading issues.

---

## Real-world usage –ø—Ä–∏–º–µ—Ä—ã

### –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç QuickMacHotKey –∏–ª–∏ NSEvent:

- **OmniFocus** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç NSEvent –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö hotkeys
- **Alfred** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç CGEventTap (–Ω–æ —ç—Ç–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ)
- **Raycast** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç NSEvent Global Monitor
- **PopClip** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç NSEvent –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

## –†–µ–∞–ª—å–Ω—ã–π –∫—Ä–∞—à –ª–æ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ö—Ä–∞—à 1: –¢–∏–ø–∏—á–Ω—ã–π F9 crash
```
Exception Type:        EXC_BREAKPOINT (SIGTRAP)
Exception Codes:       0x00000001, 0x00000000
Exception Note:        EXC_CORPSE_NOTIFY

Thread 0 Crashed:: Dispatch queue: com.apple.main-thread
0   com.apple.HIToolbox                  0x7fff2b5c4594 TSMGetInputSourceProperty + 56
1   pynput._util.darwin                  0x104c8a3a4 <–∫–æ—Ä—è–≤–æ_—Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π_–∫–æ–¥> + 120
```

### –ö—Ä–∞—à 2: –ù–∞ —Ä–∞–∑–Ω—ã—Ö macOS –≤–µ—Ä—Å–∏—è—Ö
```
macOS 14.6.1: –†–∞–±–æ—Ç–∞–µ—Ç (–Ω–æ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ)
macOS 15.0-15.1: –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∫—Ä–∞—Ö–∏
macOS 15.2+: –ö—Ä–∞—Ö–∏ –ø—Ä–∏ 80% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
```

### –ö—Ä–∞—à 3: –¢–æ–ª—å–∫–æ –Ω–∞ Apple Silicon
```
MacBook Air M1/M2/M3: –í–°–ï–ì–î–ê –∫—Ä–∞—à–∏—Ç
Intel MacBook Pro: –ò–Ω–æ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–æ –Ω–µ –Ω–∞–¥–µ–∂–Ω–æ)
```

–í—ã–≤–æ–¥: –≠—Ç–æ apple silicon + macOS 15.x —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ pynput.

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ Input Source API?

pynput –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `TSMGetInputSourceProperty` –¥–ª—è:
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ keyboard layout
- –ü—Ä–æ–≤–µ—Ä–∫–∏ dead keys
- –ê–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—É—â–µ–≥–æ input method

–≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∏—Ä–∏–ª–ª–∏—Ü–∞).

### –ü–æ—á–µ–º—É —ç—Ç–æ –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫?

macOS —Ç—Ä–µ–±—É–µ—Ç main thread –¥–ª—è –≤—Å–µ—Ö Cocoa API –ø–æ—Ç–æ–º—É —á—Ç–æ:
- Cocoa UIKit thread-affine (–≤—Å–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ)
- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç consistency UI state
- macOS –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏—è —Ç–æ–ª—å–∫–æ –≤ main thread event loop

### –ü–æ—á–µ–º—É pynput —ç—Ç–æ –¥–µ–ª–∞–µ—Ç –∏–∑ —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞?

–ù–∞—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –æ—Ç —Å—Ç–∞—Ä—ã—Ö macOS –≤–µ—Ä—Å–∏–π –∫–æ–≥–¥–∞ —ç—Ç–æ –±—ã–ª–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ.
Apple –Ω–∞—á–∞–ª —Å—Ç—Ä–æ–∂–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —ç—Ç–æ –≤ Sequoia.

---

## –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

### macOS –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
```
10.15-12.x: pynput —Ä–∞–±–æ—Ç–∞–ª (–Ω–æ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ)
13.x-14.x: –í—Å—Ç—Ä–µ—á–∞–ª–∏—Å—å –æ—à–∏–±–∫–∏, –∑–∞–≤–∏—Å–µ–ª–æ –æ—Ç hardware
15.x: –ü–æ–ª–Ω—ã–π –∫—Ä–∞—à (Apple —É—Å–∏–ª–∏–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ thread-safety)
```

### pynput –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```
1.7.6: –ù–∞—á–∞–ª–∏ –ø–æ—è–≤–ª—è—Ç—å—Å—è –∂–∞–ª–æ–±—ã
1.8.0: –ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏
1.8.1+: –û–±–µ—â–∞–ª–∏ fix, –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
```

---

## –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è: QuickMacHotKey ‚úÖ
- **–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** 99%
- **–õ–µ–≥–∫–æ—Å—Ç—å:** –û—á–µ–Ω—å –ª–µ–≥–∫–æ

### –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è: NSEvent ‚úÖ
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** 99%
- **–õ–µ–≥–∫–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω–µ

### –î–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤: CGEventTap üî¨
- **–í—Ä–µ–º—è:** 1.5+ —á–∞—Å–∞
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** 95%
- **–õ–µ–≥–∫–æ—Å—Ç—å:** –°–ª–æ–∂–Ω–æ

### –ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: –ß—Ç–æ-–ª–∏–±–æ –¥—Ä—É–≥–æ–µ ‚ùå

---

## –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏

- [ ] –í—ã–±—Ä–∞–ª QuickMacHotKey –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install quickmachotkey pyobjc-framework-Cocoa`
- [ ] –ó–∞–º–µ–Ω–∏–ª pynput –Ω–∞ QuickMacHotKey –≤ –∫–æ–¥–µ
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] –û–±–Ω–æ–≤–∏–ª requirements.txt
- [ ] –°–æ–∑–¥–∞–ª –Ω–æ–≤—ã–π spec –¥–ª—è PyInstaller
- [ ] –°–æ–±—Ä–∞–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –î–∞–ª —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤ System Preferences -> Accessibility
- [ ] –ü–æ–¥–ø–∏—Å–∞–ª app: `codesign -s - dist/VTT.app --deep`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª —Ñ–∏–Ω–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é
- [ ] –ó–∞–≥—Ä—É–∑–∏–ª –≤ Releases

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å –≤–µ—Ä—Å–∏—é macOS: `sw_vers`
2. –ü—Ä–æ–≤–µ—Ä—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É: `uname -m` (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `arm64`)
3. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: `log show --level debug --predicate 'process == "VTT"'`
4. –ó–∞–ø—É—Å—Ç–∏ —Å –æ—Ç–ª–∞–¥–∫–æ–π —á–µ—Ä–µ–∑ lldb

---

‚úÖ **–í—Å–µ –≥–æ—Ç–æ–≤–æ –¥–ª—è –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏!**
